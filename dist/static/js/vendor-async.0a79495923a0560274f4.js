webpackJsonp([0],{"98rD":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Wj+m"),r=o("VKSY"),i=function(){function t(t,e){this.store=t,this.day=e}return t.prototype.getAuctionInfo=function(){var t=this.store.queryStore(this.auctionId),e=new n.AuctionInfoView(t);return e.process=this.getProcess(e),e},t.prototype.getProcess=function(t){var e=new n.Process(t.startTime.blocktime,this.day),o=t.endTime&&t.endTime.blocktime?t.endTime.blocktime:r.tools.timetool.currentTime(),i=accSub(o,t.startTime.blocktime),s=0;if(t.state==n.AuctionState.fixed)e.state=n.AuctionState.fixed,s=accDiv(i,3*this.day),e.timearr.length=3;else if(t.state==n.AuctionState.random)e.state=n.AuctionState.random,s=accDiv(i,5*this.day),e.timearr.length=5;else{e.state=n.AuctionState.end;var a=accSub(t.addwho.lastTime.blocktime,t.startTime.blocktime);a<2*this.day?(s=accDiv(i,3*this.day),e.timearr.length=3):(s=accDiv(i,5*this.day),e.timearr.length=5)}var u=s>=1?100:accMul(s,100);return e.width=parseFloat(u.toFixed(2)),e},t}();e.AuctionInfoService=i},"9vCx":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("Wj+m"),r=o("5LD5"),i=function(){function t(t){this.tablename=t,this.session=new r.sessionStoreTool(t)}return t.prototype.setSotre=function(t,e){var o=this.session.getList();o=o||{};for(var r=0;r<t.length;r++){var i=t[r];if(i.auctionState!=n.AuctionState.pass){if(i.addwholist)for(var s=0;s<i.addwholist.length;s++){var a=i.addwholist[s];a.address==e&&(i.addWho=a)}o[i.auctionId]=i}else delete o[i.auctionId]}this.session.setList(o)},t.prototype.getSotre=function(){var t=this.session.getList(),e=[];for(var o in t)if(t.hasOwnProperty(o)){var n=t[o];e.push(n)}return e},t.prototype.push=function(t){var e=this.session.getList();e[t.auctionId]=t,this.session.setList(e)},t.prototype.queryStore=function(t){return this.session.select(t)},t}();e.AuctionStore=i},"9xxT":function(t,e,o){"use strict";var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?r(t.value):new o(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){function o(t){return function(e){return n([t,e])}}function n(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[0,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,i=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],i=0}finally{r=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var i=o("VKSY"),s=o("6nHw"),a=function(){function t(){}return t.prototype.exchangeCGas=function(t){return n(this,void 0,void 0,function(){var e,o,n,a,u,c,l,h,d,f;return r(this,function(r){switch(r.label){case 0:e=i.tools.contract.buildScript(i.tools.coinTool.id_SGAS,"mintTokens",[]),o=ThinNeo.Helper.GetAddressFromScriptHash(i.tools.coinTool.id_SGAS),n=new s.Result,r.label=1;case 1:return r.trys.push([1,7,,8]),[4,i.tools.coinTool.getassets()];case 2:return a=r.sent(),(u=i.tools.coinTool.makeTran(a,o,i.tools.coinTool.id_GAS,Neo.Fixed8.fromNumber(t)),c=u.info.tran,u.err)?[3,6]:c.inputs.length+c.outputs.length>60?(n.err=!0,n.info={code:"1006",msg:""},[2,n]):[3,3];case 3:return c.type=ThinNeo.TransactionType.InvocationTransaction,c.extdata=new ThinNeo.InvokeTransData,c.extdata.script=e,c.extdata.gas=Neo.Fixed8.fromNumber(0),[4,i.tools.coinTool.signData(c)];case 4:return l=r.sent(),[4,i.tools.wwwtool.api_postRawTransaction(l)];case 5:return h=r.sent(),n.err=!h.sendrawtransactionresult,n.err?n.info={code:"-100",msg:""}:(d=u.info.oldarr,s.OldUTXO.setOldutxos(d),n.info=h.txid),[2,n];case 6:return[3,8];case 7:throw f=r.sent();case 8:return[2]}})})},t.prototype.exchangeGas=function(){return n(this,void 0,void 0,function(){return r(this,function(t){return[2]})})},t.prototype.splitUtxo=function(){return n(this,void 0,void 0,function(){var t,e,o,n,a,u,c,l,h,d,f,p,w;return r(this,function(r){switch(r.label){case 0:return[4,i.tools.coinTool.getassets()];case 1:t=r.sent(),e=t[i.tools.coinTool.id_GAS],o=new ThinNeo.Transaction,o.type=ThinNeo.TransactionType.ContractTransaction,o.version=0,o.extdata=null,o.attributes=[],o.inputs=[],o.outputs=[],o.witnesses=null==o.witnesses?[]:o.witnesses,n=Neo.Fixed8.Zero;for(a in e)if(u=e[a],c=new ThinNeo.TransactionInput,c.hash=u.txid.hexToBytes().reverse(),c.index=u.n,o.inputs.push(c),n=n.add(u.count),n.compareTo(Neo.Fixed8.fromNumber(60))>1)break;for(l=0;l<600;l++)h=new ThinNeo.TransactionOutput,h.assetId=i.tools.coinTool.id_GAS.hexToBytes().reverse(),h.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(s.LoginInfo.getCurrentAddress()),h.value=Neo.Fixed8.fromNumber(.1),o.outputs.push(h);return d=n.subtract(Neo.Fixed8.fromNumber(61)),f=new ThinNeo.TransactionOutput,f.assetId=i.tools.coinTool.id_GAS.hexToBytes().reverse(),f.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(s.LoginInfo.getCurrentAddress()),f.value=d,o.outputs.push(f),[4,i.tools.coinTool.signData(o)];case 2:return p=r.sent(),[4,i.tools.wwwtool.api_postRawTransaction(p)];case 3:return w=r.sent(),console.log(w),[2]}})})},t}();e.ExchangeService=a},VYSC:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("9vCx");!function(t){t.auction_neo=new n.AuctionStore("AUCTION_LIST_NEO"),t.auction_test=new n.AuctionStore("AUCTION_LIST_TEST")}(e.store||(e.store={}))},oeIN:function(t,e,o){"use strict";var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function s(t){try{u(n.next(t))}catch(t){i(t)}}function a(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?r(t.value):new o(function(e){e(t.value)}).then(s,a)}u((n=n.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){function o(t){return function(e){return n([t,e])}}function n(o){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,i&&(s=i[2&o[0]?"return":o[0]?"throw":"next"])&&!(s=s.call(i,o[1])).done)return s;switch(i=0,s&&(o=[0,s.value]),o[0]){case 0:case 1:s=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,i=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(s=u.trys,!(s=s.length>0&&s[s.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!s||o[1]>s[0]&&o[1]<s[3])){u.label=o[1];break}if(6===o[0]&&u.label<s[1]){u.label=s[1],s=o;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(o);break}s[2]&&u.ops.pop(),u.trys.pop();continue}o=e.call(t,u)}catch(t){o=[6,t],i=0}finally{r=s=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}var r,i,s,a,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a};Object.defineProperty(e,"__esModule",{value:!0});var i=o("Wj+m"),s=o("VKSY"),a=o("6nHw"),u=function(){function t(t){this.store=t}return t.prototype.getMyAuctionList=function(t,e,o){return n(this,void 0,void 0,function(){var e,o,n,s,a,a;return r(this,function(r){switch(r.label){case 0:return e=[],[4,this.getAuctionList(t)];case 1:for(o=r.sent(),o=o||[],n=0;n<o.length;n++)s=o[n],s.auctionState!=i.AuctionState.open&&(s.auctionState==i.AuctionState.end?s.addWho&&(a=new i.AuctionView(s),e.push(a)):(a=new i.AuctionView(s),e.push(a)));return e.sort(function(t,e){return e.startTime.blocktime-t.startTime.blocktime}),[2,e]}})})},t.prototype.getAuctionList=function(t){return n(this,void 0,void 0,function(){var e,o,n,i,a,u;return r(this,function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),e=this.store.getSotre(),e&&e.length>0?[2,e]:[3,1];case 1:return[4,s.tools.wwwtool.getauctioninfocount(t,"."+this.root.rootname)];case 2:return o=r.sent(),[4,s.tools.wwwtool.getauctioninfobyaddress(t,1,o,"."+this.root.rootname)];case 3:return n=r.sent(),n?(i=n[0].list,this.store.setSotre(i,t),i=this.store.getSotre(),[2,i]):(a=this.store.getSotre(),[2,a||[]]);case 4:return[3,6];case 5:return u=r.sent(),[3,6];case 6:return[2]}})})},t.prototype.updateAuctionList=function(t){return n(this,void 0,void 0,function(){var e,o,n,u,c,l;return r(this,function(r){switch(r.label){case 0:for(e=this.store.getSotre(),o=[],n=0;n<e.length;n++)u=e[n],u.auctionState==i.AuctionState.end?u.addWho&&(u.maxBuyer==u.addWho.address?u.addWho.getdomainTime||o.push(u.auctionId):u.addWho.accountTime||o.push(u.auctionId)):o.push(u.auctionId);return[4,s.tools.wwwtool.getauctioninfobyaucitonid(t,o,"."+this.root.rootname)];case 1:return c=r.sent(),c&&(l=c[0].list,this.store.setSotre(l,t),this.auctionList=this.store.getSotre()),a.TaskFunction.auctionStateUpdate&&a.TaskFunction.auctionStateUpdate(),[2]}})})},t.prototype.queryAuctionByDomain=function(t){return n(this,void 0,void 0,function(){var e,o,n;return r(this,function(r){switch(r.label){case 0:return[4,s.tools.nnssell.getSellingStateByDomain(t,this.root)];case 1:return e=r.sent(),(o=new i.Auction,e.id)?(n="neo"==this.root.rootname?86400:300,[4,s.tools.nnssell.getAuctionByStateInfo(e,n)]):[3,3];case 2:return o=r.sent(),[2,o];case 3:return[2,o]}})})},t.prototype.fuzzyQueryDomain=function(t){var e=this.store.getSotre(),o=[];for(var n in e){var r=e[n];if(r.fulldomain.includes(t)){var s=new i.AuctionView(r);o.push(s)}}return o},t.prototype.startAuction=function(t){return n(this,void 0,void 0,function(){var e,o,n,u,c,l,h,d,f;return r(this,function(r){switch(r.label){case 0:e=a.LoginInfo.getCurrentAddress(),o=[t,this.root.rootname].join("."),n=new i.Auction,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,s.tools.nnssell.startAuciton(t,this.root)];case 2:return u=r.sent(),c=u.info,l=new a.Task(a.ConfirmType.contract,c,{domain:o}),s.tools.taskManager.addTask(l,a.TaskType.openAuction),[4,s.tools.wwwtool.getauctioninfobyaucitonid(e,[c],"."+this.root.rootname)];case 3:return h=r.sent(),h?(d=u[0].list,n.parse(d[0],e)):(n.auctionId=c,n.domain=t,n.fulldomain=o,n.auctionState=i.AuctionState.open),this.store.push(n),[2,c];case 4:return f=r.sent(),[3,5];case 5:return[2]}})})},t.prototype.auctionRaise=function(t,e,o,u){return n(this,void 0,void 0,function(){var n,c,l,h,d,f,p,w,v;return r(this,function(r){switch(r.label){case 0:n=a.LoginInfo.getCurrentAddress(),c=new a.Result,r.label=1;case 1:return r.trys.push([1,6,,7]),[4,s.tools.nnssell.raise(t,o,u)];case 2:return l=r.sent(),l.err?[3,4]:(h=l.info,d=new a.Task(a.ConfirmType.contract,h,{domain:e,amount:o}),s.tools.taskManager.addTask(d,a.TaskType.addPrice),[4,s.tools.wwwtool.getauctioninfobyaucitonid("",[t],"."+this.root.rootname)]);case 3:return f=r.sent(),p=new i.Auction,c?(c.err=!1,c.info=h,w=f[0].list,p.parse(w[0],n)):p.auctionState=i.AuctionState.open,this.store.push(p),[3,5];case 4:c.err=!0,c.info="raise fail",r.label=5;case 5:return[2,c];case 6:throw v=r.sent();case 7:return[2]}})})},t.prototype.pushAuctionToSession=function(t){var e=a.LoginInfo.getCurrentAddress(),o=this.store.getSotre();o.push(t),this.store.setSotre(o,e)},t}();e.AuctionService=u},r84I:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=o("98rD"),r=o("oeIN"),i=o("9xxT"),s=o("VYSC");!function(t){t.auction_neo=new r.AuctionService(s.store.auction_neo),t.auctionInfo_neo=new n.AuctionInfoService(s.store.auction_neo,86400),t.exchange=new i.ExchangeService}(e.services||(e.services={}))}});